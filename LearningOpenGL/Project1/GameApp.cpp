#include "SkyBox.h"
#include "GameApp.h"

//--------------------------------------------------------------------------------------------
GameApp::GameApp()
{
	p_InputManager = new InputManager();
	p_Level = new Level();
	mp_Player = new Player();
	mp_SkyBox = new SkyBox();
	mp_Ground = new Ground();
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
GameApp::~GameApp()
{

}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::Update(int msTime, bool isPlaying)
{
	p_InputManager->Update(msTime);

	if (isPlaying)
	{
		update(msTime);
	}
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::CleanUp()
{
	p_InputManager->CleanUp();
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::Init()
{
	p_InputManager->Init();
	p_Level->Init("hello");
	mp_SkyBox->Init();
	mp_Player->Init();
	mp_Player->GetPlayer()->setMass(1);
	p_Level->AddGameObject(mp_Player->GetPlayer());
	mp_Ground->Init();
	mp_Ground->setDamping(0);
	mp_Ground->setMass(1000000000);
	mp_Ground->SetTexture("grass.jpg");
	mp_Ground->setPos(Vector3D(0, -20, 0));
	mp_Ground->SetDim(Vector3D(50, -mp_Ground->getPos().Y, 50));

}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::Draw()
{
	mp_SkyBox->RenderSkyBox();
	p_Level->Draw();
	mp_Ground->Draw();
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::HandleKeyDown(unsigned char key)
{
	p_InputManager->HandleKeyDown(key);
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::HandleMouse(Vector2D mousePos)
{
	p_InputManager->HandleMouse(mousePos);
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::HandleMouseDown(Vector2D buttonAndState, Vector2D mousePos)
{
	p_InputManager->HandleMouseDown(buttonAndState, mousePos);
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::update(int msTime)
{
	p_Level->Update(msTime);
}
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
void GameApp::Reset()
{
	mp_Player->Reset();
	//reset Level
}
//--------------------------------------------------------------------------------------------